{
  "execute_on": "ve",

  "name": "Map Serial Device",
  "description": "Map serial device to VM",
  "skip_if_all_missing": ["serial_host"],
  "parameters": [

    {
      "id": "serial_host",
      "name": "Path to USB Serial Device",
      "type": "string",
      "required": false,
      "default": "/dev/ttyUSB0",
      "description": "Path to the USB device on the Proxmox host"
    },
    {
      "id": "vm_id",
      "name": "ID of the VM",
      "type": "string",
      "required": true,
      "description": "ID of the VM to which the USB device will be assigned"
    },
    {
      "id": "uid",
      "name": "UID",
      "type": "string",
      "required": false,
      "advanced": true,
      "description": "Optional: UID of the user in the container who should have access to the serial device. If provided, permissions will be set on the host device (mapped UID = container UID + 100000)."
    },
    {
      "id": "gid",
      "name": "GID",
      "type": "string",
      "required": false,
      "advanced": true,
      "description": "Optional: GID of the group in the container who should have access to the serial device. If provided, permissions will be set on the host device (mapped GID = container GID + 100000)."
    }
  ],
  "commands": [
    {
      "name": "Map Serial Device",
      "if": "{{ usb }}",
      "script": "map-serial-device.sh"
    }
  ]
}
